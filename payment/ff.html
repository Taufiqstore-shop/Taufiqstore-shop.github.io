<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment Free Fire - Taufiqshop</title>
<link rel="icon" href="../favicon.jpg">
</head>

<body style="
margin:0;
font-family:Arial;
background: radial-gradient(circle at top, #00ff9c 0%, #00331f 40%, #000000 80%);
color:white;
text-align:center;
">

<h2 style="margin-top:20px;">PAYMENT TAUFIQSHOP</h2>
<p style="opacity:0.8;">Cek data sebelum pembayaran</p>

<!-- DETAIL ORDER -->
<div style="
max-width:420px;
margin:20px auto;
padding:15px;
background:rgba(0,0,0,0.65);
border-radius:12px;
text-align:left;
">
<h3 style="text-align:center;">Detail Order</h3>
<p><b>Game:</b> <span id="game"></span></p>
<p><b>ID Player:</b> <span id="playerId"></span></p>
<p><b>Nickname:</b> <span id="nickname"></span></p>
<p><b>Item:</b> <span id="item"></span></p>
<p><b>Harga:</b> Rp <span id="harga"></span></p>
</div>

<!-- STATUS -->
<h3 id="statusBox" style="color:#00ff9c;">‚è≥ Waiting Payment</h3>

<!-- PESAN ANTRIAN ADMIN -->
<div style="
max-width:420px;
margin:15px auto;
padding:12px;
background:rgba(0,0,0,0.6);
border-radius:10px;
font-size:14px;
line-height:1.5;
">
Pesanan kamu sedang ditambahkan ke antrian admin.<br>
Mohon bersabar, pesanan akan segera diproses oleh admin.<br>
Jika membutuhkan bantuan, silakan hubungi admin via
<b>Telegram</b> atau <b>WhatsApp</b>.
</div>

<!-- QRIS -->
<div id="qrisBox" style="
margin:20px auto;
padding:15px;
width:260px;
background:white;
border-radius:12px;
">
  <img src="../qris.png" style="width:100%;">
</div>

<p style="font-size:13px; opacity:0.7;">
Scan QRIS di atas untuk melakukan pembayaran
</p>

<script>
const statusBox = document.getElementById("statusBox");
const qrisBox = document.getElementById("qrisBox");

const orderId = localStorage.getItem("lastOrderId");
let orders = JSON.parse(localStorage.getItem("orders")) || [];
let order = orders.find(o => o.orderId == orderId);

if(!order){
  alert("Order tidak ditemukan");
}else{
  document.getElementById("game").innerText = order.game;
  document.getElementById("playerId").innerText = order.playerId;
  document.getElementById("nickname").innerText = order.nickname;
  document.getElementById("item").innerText = order.item;
  document.getElementById("harga").innerText = order.harga;
  updateStatus(order.status);
}

/* CEK STATUS REALTIME */
setInterval(()=>{
  orders = JSON.parse(localStorage.getItem("orders")) || [];
  order = orders.find(o => o.orderId == orderId);
  if(order){
    updateStatus(order.status);
  }
},2000);

/* UPDATE STATUS */
function updateStatus(status){
  if(status === "MENUNGGU"){
    statusBox.innerHTML = "‚è≥ Waiting Payment";
    statusBox.style.color = "#00ff9c";
    qrisBox.style.display = "block";
  }

  if(status === "PROSES"){
    statusBox.innerHTML = "üîÑ Pembayaran sedang dicek admin";
    statusBox.style.color = "#ffaa00";
    qrisBox.style.display = "block";
  }

  if(status === "SUKSES"){
    statusBox.innerHTML = "‚úÖ PEMBAYARAN BERHASIL<br>Diamond sedang dikirim";
    statusBox.style.color = "#00ff9c";
    qrisBox.style.display = "none";
  }

  if(status === "GAGAL"){
    statusBox.innerHTML = "‚ùå PEMBAYARAN GAGAL<br>Hubungi admin";
    statusBox.style.color = "#ff4d4d";
    qrisBox.style.display = "block";
  }
}

/* üî• ILUSI: BALIK DARI E-WALLET */
document.addEventListener("visibilitychange", () => {
  if (document.visibilityState === "visible") {
    let orders = JSON.parse(localStorage.getItem("orders")) || [];
    let index = orders.findIndex(o => o.orderId == orderId);
    if(index !== -1 && orders[index].status === "MENUNGGU"){
      orders[index].status = "PROSES";
      localStorage.setItem("orders", JSON.stringify(orders));
    }
  }
});
</script>

</body>
</html>
